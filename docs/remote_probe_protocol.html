<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- 
  <link rel="icon" type="image/png" href="/assets/images/favicon.png" />
 -->

  <link rel="preconnect" href="https://fonts.googleapis.com"> 
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> 
  
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;1,100;1,200;1,300;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:ital,wght@0,200;0,300;0,400;0,600;0,700;0,800;0,900;1,200;1,300;1,400;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">

  <link rel="stylesheet" href="/assets/styles/main.css">

  <title>Remote probe protocol &mdash; pyOCD</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-2RKCB4KZ7S"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-2RKCB4KZ7S');
  </script>
</head>

  <body id="top">
    <div class="full-view-height d-flex flex-column">
      <div class="flex-shrink-0">
        <nav class="navbar navbar-expand-md navbar-dark py-1">
  <div class="container-fluid">
    <a class="navbar-brand" href="/">
      <img src="/assets/pyocd_logo_white.svg" height="42" width="auto" alt=""></img>
    </a>
    <a class="navbar-brand color-secondary" href="/">
      <span class="display-lg project-name">pyOCD</span>
    </a>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse justify-content-end" id="navbarCollapse">
      <ul class="navbar-nav">
        
        
        <li class="nav-item mr-auto mx-1">
          <a class="nav-link" href="/docs/">Documentation</a>
        </li>
        
        <li class="nav-item mr-auto mx-1">
          <a class="nav-link" href="/posts/">Posts</a>
        </li>
        
        <li class="nav-item mr-auto mx-1">
          <a class="nav-link" href="https://github.com/pyocd/pyOCD"><i class="bi bi-github"></i></a>
        </li>
        
      </ul>
    </div>
  </div>
</nav>

      </div>
      <div class="container-fluid flex-grow-1 p-0">
        <div class="row">
          <div class="col-md-3 col-sm-0 d-sm-none d-md-block p-0">
            

<div class="sidebar docs-sidebar-1" id="sidebar1">
  <div class="p-4">
    <h5 class="sidebar-header level-1">Getting started</h5>
    <ul class="list-unstyled level-1">
    <li class="sidebar-item level-1">
            <a href="/docs/installing.html" class="sidebar-link ">Installing</a>
            </li>
          <li class="sidebar-item level-1">
            <a href="/docs/installing_on_non_x86.html" class="sidebar-link ">Installing on non-x86 platforms</a>
            </li>
          <li class="sidebar-item level-1">
            <a href="/docs/gdb_setup.html" class="sidebar-link ">GDB setup</a>
            </li>
          </ul>
    <h5 class="sidebar-header level-1">User documentation</h5>
    <ul class="list-unstyled level-1">
    <li class="sidebar-item level-1">
            <a href="/docs/target_support.html" class="sidebar-link ">Target support</a>
            </li>
          <li class="sidebar-item level-1">
            <a href="/docs/debug_probes.html" class="sidebar-link ">Debug probes</a>
            </li>
          <li class="sidebar-item level-1">
            <a href="/docs/configuration.html" class="sidebar-link ">Configuration</a>
            </li>
          <li class="sidebar-item level-1">
            <a href="/docs/user_scripts.html" class="sidebar-link ">User scripts</a>
            </li>
          <li class="sidebar-item level-1">
            <a href="/docs/remote_probe_access.html" class="sidebar-link ">Remote probe access</a>
            </li>
          <li class="sidebar-item level-1">
            <a href="/docs/configuring_logging.html" class="sidebar-link ">Configuring logging</a>
            </li>
          <li class="sidebar-item level-1">
            <a href="/docs/security.html" class="sidebar-link ">Security and protection</a>
            </li>
          <li class="sidebar-item level-1">
            <a href="/docs/multicore_debug.html" class="sidebar-link ">Multicore debug</a>
            </li>
          <li class="sidebar-item level-1">
            <a href="/docs/semihosting.html" class="sidebar-link ">Semihosting</a>
            </li>
          <li class="sidebar-item level-1">
            <a href="/docs/swo_swv.html" class="sidebar-link ">SWO/SWV</a>
            </li>
          <li class="sidebar-item level-1">
            <a href="/docs/target_family_notes.html" class="sidebar-link ">Target family usage notes</a>
            </li>
          </ul>
    <h5 class="sidebar-header level-1">Reference</h5>
    <ul class="list-unstyled level-1">
    <li class="sidebar-item level-1">
            <a href="/docs/terminology.html" class="sidebar-link ">Terminology</a>
            </li>
          <li class="sidebar-item level-1">
            <a href="/docs/builtin-targets.html" class="sidebar-link ">Built-in targets</a>
            </li>
          <li class="sidebar-item level-1">
            <a href="/docs/options.html" class="sidebar-link ">Session options list</a>
            </li>
          <li class="sidebar-item level-1">
            <a href="/docs/command_reference.html" class="sidebar-link ">Command reference</a>
            </li>
          <li class="sidebar-item level-1">
            <a href="/docs/env_vars.html" class="sidebar-link ">Environment variables</a>
            </li>
          </ul>
    <h5 class="sidebar-header level-1">Python API</h5>
    <ul class="list-unstyled level-1">
    <li class="sidebar-item level-1">
            <a href="/docs/python_api.html" class="sidebar-link ">Introduction to the API</a>
            </li>
          <li class="sidebar-item level-1">
            <a href="/docs/api_examples.html" class="sidebar-link ">Python API examples</a>
            </li>
          </ul>
    <h5 class="sidebar-header level-1">Developers</h5>
    <ul class="list-unstyled level-1">
    <li class="sidebar-item level-1">
            <a href="/docs/developers_guide.html" class="sidebar-link ">Developers' guide</a>
            </li>
          <li class="sidebar-item level-1">
            <a href="/docs/adding_new_targets.html" class="sidebar-link ">Adding a new built-in target</a>
            </li>
          <li class="sidebar-item level-1">
            <a href="/docs/automated_tests.html" class="sidebar-link ">Automated tests</a>
            </li>
          <li>
        <p class="sidebar-header level-2">
          Internal design
        </p>
        <ul class="list-unstyled level-2">
        <li class="sidebar-item level-2">
              <a href="/docs/architecture.html" class="sidebar-link ">Architecture</a>
              </li>
            <li class="sidebar-item level-2">
              <p class="sidebar-item-selected">Remote probe protocol</p>
              </li>
            </ul>
        </li></ul>
    </div>
</div>

          </div>
          <div class="col-md-9 col-sm-12 p-0">
            <main role="main" class="content-scroll p-4" data-spy="scroll" data-target="#components-nav" data-offset="0">

              

              
              <div class="row">
                <div class="d-sm-block d-md-none">
                  <p class=""><b>&larr;</b> <a href="/docs/index">Documentation index</a></p>
                </div>
              </div>
              

              <div class="row">
                <div class="container docs-content">
                  
                  <h1 class="mb-4 mt-0">Remote probe protocol</h1>
                  

                  <!-- floating table of contents -->
                  <div class="col-lg-4 col-md-3 float-md-end ms-md-3 mb-sm-3" id="toc-div">
                    <div class="sidebar docs-sidebar-2 p-4">
                        <h5 class="sidebar-header">On this page</h5>
                        <ul id="toc" class="section-nav">
<li class="toc-entry toc-h2"><a href="#protocol">Protocol</a>
<ul>
<li class="toc-entry toc-h3"><a href="#request-structure">Request structure</a></li>
<li class="toc-entry toc-h3"><a href="#response-structure">Response structure</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#commands">Commands</a></li>
<li class="toc-entry toc-h2"><a href="#semantics">Semantics</a></li>
</ul>
                    </div>
                  </div>

                  <p>PyOCD provides a server and client for sharing and accessing debug probes across a TCP/IP
network connection. This document describes the protocol design, available commands, and semantics.</p>

<h2 id="protocol">Protocol</h2>

<p>The protocol is very simple. Each request from the client is a single line comprised of the
request encoded as JSON and followed by a single LF character (0x0A). The response from the server
is the same format, with a JSON encoded reply plus LF.</p>

<p>A unique request ID is sent with every request. The response includes the ID of the request to
which it belongs.</p>

<p>All requests are sent by the client. (A notification system from server to client may be added.)</p>

<h3 id="request-structure">Request structure</h3>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "id": &lt;int&gt;,
  "request": &lt;str&gt;,
  "arguments": [
  ]
}
</code></pre></div></div>

<p>The <code class="highlighter-rouge">arguments</code> key is a list of any arguments for the command. It may be elided if there are no
arguments required.</p>

<h3 id="response-structure">Response structure</h3>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "id": &lt;int&gt;,
  "status": &lt;int&gt;,
  ["error": &lt;str&gt;,]
  ["result": &lt;value&gt;]
}
</code></pre></div></div>

<p>A successful response must have a <code class="highlighter-rouge">status</code> value of 0. A non-zero <code class="highlighter-rouge">status</code> indicates that an error
occurred, and must be accompanied by an <code class="highlighter-rouge">error</code> key with an error message (may be the empty string).
If the response is successful, then a <code class="highlighter-rouge">result</code> key may be included with the return value of the
command. If there is no return value, then <code class="highlighter-rouge">result</code> is excluded.</p>

<h2 id="commands">Commands</h2>

<p>The commands in the table below correspond directly to the methods of <code class="highlighter-rouge">DebugProbe</code>.</p>

<table>
  <thead>
    <tr>
      <th>Command</th>
      <th>Arguments</th>
      <th>Result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">hello</code></td>
      <td>version:int</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">readprop</code></td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">open</code></td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">close</code></td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">lock</code></td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">unlock</code></td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">connect</code></td>
      <td>protocol:str</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">disconnect</code></td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">swj_sequence</code></td>
      <td>length:int, bits:int</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">set_clock</code></td>
      <td>freq:int</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">reset</code></td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">assert_reset</code></td>
      <td>asserted:bool</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">is_reset_asserted</code></td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">flush</code></td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">read_dp</code></td>
      <td>addr:int</td>
      <td>int</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">write_dp</code></td>
      <td>addr:int, data:int</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">read_ap</code></td>
      <td>addr:int</td>
      <td>int</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">write_ap</code></td>
      <td>addr:int, data:int</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">read_ap_multiple</code></td>
      <td>addr:int, count:int</td>
      <td>List[int]</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">write_ap_multiple</code></td>
      <td>addr:int, data:List[int]</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">swo_start</code></td>
      <td>baudrate:int</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">swo_stop</code></td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">swo_read</code></td>
      <td> </td>
      <td>List[int]</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">get_memory_interface_for_ap</code></td>
      <td>ap_address_version:int, ap_nominal_address:int</td>
      <td>Option[int]</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">read_mem</code></td>
      <td>handle:int, addr:int, xfer_size:int</td>
      <td>int</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">write_mem</code></td>
      <td>handle:int, addr:int, value:int, xfer_size:int</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">read_block32</code></td>
      <td>handle:int, addr:int, word_count:int</td>
      <td>List[int]</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">write_block32</code></td>
      <td>handle:int, addr:int, data:List[int]</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">read_block8</code></td>
      <td>handle:int, addr:int, word_count:int</td>
      <td>List[int]</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">write_block8</code></td>
      <td>handle:int, addr:int, data:List[int]</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h2 id="semantics">Semantics</h2>

<p>The <code class="highlighter-rouge">hello</code> command includes the version of the remote probe protocol supported by the client. The
server will return an error if this version doesn’t match the version of the protocol supported by
the server.</p>

<p>Multiple clients may connect to a single remote probe. The server manages the requests to ensure
that the underlying probe is only opened and connected once. The first client to connect a probe
gets to choose the wire protocol (e.g., SWD or JTAG); subsequent connect are effectively ignored.
Counts of clients who have opened and connected the probe are maintained so it is disconnected
and closed when the last client disconnects and closes.</p>



                </div>
              </div>
            </main>

          </div>
        </div>
      </div>

      <div class="flex-shrink-0">
        <footer class="pyocd-footer p-0 mt-3">
  <div class="row row-cols-1 row-cols-sm-2 row-cols-md-4 pt-4">
    <div class="col-3">
      <p class="small">
          Copyright &copy; 2021-2022 PyOCD Authors.
      </p>
      <p class="small">
        Site and docs are <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>.<br/>
        Project code is <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache 2.0</a>.
      </p>
    </div>
    <div class="col-3">  <!-- mt-3 mb-3 mx-4 -->
      <h5>Links</h5>
      <ul class="list-unstyled">
        <li>
          <a href="/docs/">Documentation</a>
        </li>
        <li>
          <a href="/posts/">Posts</a>
        </li>
        <li>
          <a href="https://github.com/pyocd/pyOCD/blob/main/CONTRIBUTING.md">Contributing</a>
        </li>
        <li>
          <a href="https://github.com/pyocd/.github/blob/main/CODE_OF_CONDUCT.md">Code of Conduct</a>
        </li>
        <li>
          <a href="https://github.com/pyocd/">GitHub</a>
        </li>
      </ul>
    </div>
    <div class="col-3">
      <h5>Projects</h5>
      <ul class="list-unstyled">
        <li>
          <a href="https://github.com/pyocd/pyOCD">pyOCD</a>
        </li>
        <li>
          <a href="https://github.com/pyocd/cmsis-pack-manager">cmsis-pack-manager</a>
        </li>
        <li>
          <a href="https://github.com/pyocd/FlashAlgo">FlashAlgo</a>
        </li>
      </ul>
    </div>
    <div class="col-3">
      <h5>Community</h5>
      <ul class="list-unstyled">
        <li>
          <a href="https://github.com/pyocd/pyOCD/issues">Issues</a>
        </li>
        <li>
          <a href="https://github.com/pyocd/pyOCD/discussions">Discussions</a>
        </li>
        <li>
          <a href="https://join.slack.com/t/pyocd/shared_invite/zt-zqjv6zr5-ZfGAXl_mFCGGmFlB_8riHA">Slack</a>
        </li>
        <li>
          <a href="https://groups.google.com/g/pyocd">Mailing list</a>
        </li>
      </ul>
    </div>
  </div>
</footer>

      </div>

      <a href="#top" title="Scroll to top" id="scroll-top-link" aria-hidden="true">
        <i class="bi bi-arrow-up-short"></i>
      </a>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ" crossorigin="anonymous"></script>
<script src="/assets/javascript/jquery-3.6.0.slim.min.js"></script>
<!-- 
<script type="text/javascript" src="/assets/javascript/index.js"></script>
 -->

  </body>

<script>
// Hide the page's floating TOC if there are no sections.
if ($('#toc').children().length < 1) {
  $('#toc-div').hide()
}

// Insert icons for alerts.
$(".alert-warning").prepend("<div class=\"alert-icon\"><i class=\"bi bi-exclamation-triangle\"></i></div>")
$(".alert-info").prepend("<div class=\"alert-icon\"><i class=\"bi bi-info-circle\"></i></div>")
$(".alert-success").prepend("<div class=\"alert-icon\"><i class=\"bi bi-check-circle\"></i></div>")
</script>
</html>
