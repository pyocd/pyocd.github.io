<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- 
  <link rel="icon" type="image/png" href="/assets/images/favicon.png" />
 -->

  <link rel="preconnect" href="https://fonts.googleapis.com"> 
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> 
  
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;1,100;1,200;1,300;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:ital,wght@0,200;0,300;0,400;0,600;0,700;0,800;0,900;1,200;1,300;1,400;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">

  <link rel="stylesheet" href="/assets/styles/main.css">

  <title>Automated tests &mdash; pyOCD</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-2RKCB4KZ7S"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-2RKCB4KZ7S');
  </script>
</head>

  <body id="top">
    <div class="full-view-height d-flex flex-column">
      <div class="flex-shrink-0">
        <nav class="navbar navbar-expand-md navbar-dark py-1">
  <div class="container-fluid">
    <a class="navbar-brand" href="/">
      <img src="/assets/pyocd_logo_white.svg" height="42" width="auto" alt=""></img>
    </a>
    <a class="navbar-brand color-secondary" href="/">
      <span class="display-lg project-name">pyOCD</span>
    </a>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse justify-content-end" id="navbarCollapse">
      <ul class="navbar-nav">
        
        
        <li class="nav-item mr-auto mx-1">
          <a class="nav-link" href="/docs/">Documentation</a>
        </li>
        
        <li class="nav-item mr-auto mx-1">
          <a class="nav-link" href="/posts/">Posts</a>
        </li>
        
        <li class="nav-item mr-auto mx-1">
          <a class="nav-link" href="https://github.com/pyocd/pyOCD"><i class="bi bi-github"></i></a>
        </li>
        
      </ul>
    </div>
  </div>
</nav>

      </div>
      <div class="container-fluid flex-grow-1 p-0">
        <div class="row">
          <div class="col-md-3 col-sm-0 d-sm-none d-md-block p-0">
            

<div class="sidebar docs-sidebar-1" id="sidebar1">
  <div class="p-4">
    <h5 class="sidebar-header level-1">Getting started</h5>
    <ul class="list-unstyled level-1">
    <li class="sidebar-item level-1">
            <a href="/docs/installing.html" class="sidebar-link ">Installing</a>
            </li>
          <li class="sidebar-item level-1">
            <a href="/docs/installing_on_non_x86.html" class="sidebar-link ">Installing on non-x86 platforms</a>
            </li>
          <li class="sidebar-item level-1">
            <a href="/docs/gdb_setup.html" class="sidebar-link ">GDB setup</a>
            </li>
          </ul>
    <h5 class="sidebar-header level-1">User documentation</h5>
    <ul class="list-unstyled level-1">
    <li class="sidebar-item level-1">
            <a href="/docs/target_support.html" class="sidebar-link ">Target support</a>
            </li>
          <li class="sidebar-item level-1">
            <a href="/docs/debug_probes.html" class="sidebar-link ">Debug probes</a>
            </li>
          <li class="sidebar-item level-1">
            <a href="/docs/configuration.html" class="sidebar-link ">Configuration</a>
            </li>
          <li class="sidebar-item level-1">
            <a href="/docs/user_scripts.html" class="sidebar-link ">User scripts</a>
            </li>
          <li class="sidebar-item level-1">
            <a href="/docs/remote_probe_access.html" class="sidebar-link ">Remote probe access</a>
            </li>
          <li class="sidebar-item level-1">
            <a href="/docs/configuring_logging.html" class="sidebar-link ">Configuring logging</a>
            </li>
          <li class="sidebar-item level-1">
            <a href="/docs/security.html" class="sidebar-link ">Security and protection</a>
            </li>
          <li class="sidebar-item level-1">
            <a href="/docs/multicore_debug.html" class="sidebar-link ">Multicore debug</a>
            </li>
          <li class="sidebar-item level-1">
            <a href="/docs/semihosting.html" class="sidebar-link ">Semihosting</a>
            </li>
          <li class="sidebar-item level-1">
            <a href="/docs/swo_swv.html" class="sidebar-link ">SWO/SWV</a>
            </li>
          <li class="sidebar-item level-1">
            <a href="/docs/target_family_notes.html" class="sidebar-link ">Target family usage notes</a>
            </li>
          </ul>
    <h5 class="sidebar-header level-1">Reference</h5>
    <ul class="list-unstyled level-1">
    <li class="sidebar-item level-1">
            <a href="/docs/terminology.html" class="sidebar-link ">Terminology</a>
            </li>
          <li class="sidebar-item level-1">
            <a href="/docs/builtin-targets.html" class="sidebar-link ">Built-in targets</a>
            </li>
          <li class="sidebar-item level-1">
            <a href="/docs/options.html" class="sidebar-link ">Session options list</a>
            </li>
          <li class="sidebar-item level-1">
            <a href="/docs/command_reference.html" class="sidebar-link ">Command reference</a>
            </li>
          <li class="sidebar-item level-1">
            <a href="/docs/env_vars.html" class="sidebar-link ">Environment variables</a>
            </li>
          </ul>
    <h5 class="sidebar-header level-1">Python API</h5>
    <ul class="list-unstyled level-1">
    <li class="sidebar-item level-1">
            <a href="/docs/python_api.html" class="sidebar-link ">Introduction to the API</a>
            </li>
          <li class="sidebar-item level-1">
            <a href="/docs/api_examples.html" class="sidebar-link ">Python API examples</a>
            </li>
          <li class="sidebar-item level-1">
            <a href="/docs/api/using_session_options.html" class="sidebar-link ">Using session options</a>
            </li>
          </ul>
    <h5 class="sidebar-header level-1">Developers</h5>
    <ul class="list-unstyled level-1">
    <li class="sidebar-item level-1">
            <a href="/docs/developers_guide.html" class="sidebar-link ">Developers’ guide</a>
            </li>
          <li class="sidebar-item level-1">
            <a href="/docs/adding_new_targets.html" class="sidebar-link ">Adding a new built-in target</a>
            </li>
          <li class="sidebar-item level-1">
            <p class="sidebar-item-selected">Automated tests</p>
            </li>
          <li>
        <p class="sidebar-header level-2">
          Internal design
        </p>
        <ul class="list-unstyled level-2">
        <li class="sidebar-item level-2">
              <a href="/docs/architecture.html" class="sidebar-link ">Architecture</a>
              </li>
            <li class="sidebar-item level-2">
              <a href="/docs/developer/board_ids.html" class="sidebar-link ">Board IDs</a>
              </li>
            <li class="sidebar-item level-2">
              <a href="/docs/remote_probe_protocol.html" class="sidebar-link ">Remote probe protocol</a>
              </li>
            </ul>
        </li></ul>
    </div>
</div>

          </div>
          <div class="col-md-9 col-sm-12 p-0">
            <main role="main" class="content-scroll p-4" data-spy="scroll" data-target="#components-nav" data-offset="0">

              

              
              <div class="row">
                <div class="d-sm-block d-md-none">
                  <p class=""><b>&larr;</b> <a href="/docs/index">Documentation index</a></p>
                </div>
              </div>
              

              <div class="row">
                <div class="container docs-content">
                  
                  <h1 class="mb-4 mt-0">Automated tests</h1>
                  

                  <!-- floating table of contents -->
                  <div class="col-lg-4 col-md-3 float-md-end ms-md-3 mb-sm-3" id="toc-div">
                    <div class="sidebar docs-sidebar-2 p-4">
                        <h5 class="sidebar-header">On this page</h5>
                        <ul id="toc" class="section-nav">
<li class="toc-entry toc-h2"><a href="#unit-tests">Unit tests</a></li>
<li class="toc-entry toc-h2"><a href="#functional-tests">Functional tests</a></li>
<li class="toc-entry toc-h2"><a href="#azure-pipelines">Azure Pipelines</a></li>
<li class="toc-entry toc-h2"><a href="#testing-with-tox">Testing with tox</a></li>
<li class="toc-entry toc-h2"><a href="#test-setup">Test Setup</a></li>
</ul>
                    </div>
                  </div>

                  <p>Both unit tests and functional tests are used to verify pyOCD.</p>

<p>The primary difference between unit tests and functional tests is that unit tests will work without
a debug probe connected. Some unit tests do take advantage of a connected probe to expand testing,
but those tests will be skipped if no probe is present. In contrast, all functional tests require
at least one probe to be connected.</p>

<h2 id="unit-tests">Unit tests</h2>

<p>The unit tests are located in the <code class="highlighter-rouge">tests/unit</code> directory of the repo. They must be executed using
pytest, as they rely on the advanced capabilities of this tool.</p>

<p>To run the unit tests, simply invoke <code class="highlighter-rouge">pytest</code> in the root directory of the repo. Read the pytest
usage to see the many options it provides.</p>

<p>To get code coverage results, do the following:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ pytest --cov-report=html --cov=pyocd
$ open htmlcov/index.html
</code></pre></div></div>

<h2 id="functional-tests">Functional tests</h2>

<p>A series of quite comprehensive functional tests are provided in the <code class="highlighter-rouge">test/</code> directory. The primary
script for running these tests is <code class="highlighter-rouge">automated_test.py</code>. It will execute all functional tests in
sequence for all connected debug probes, then produce a summary and JUnit-style XML report. This
script is used to execute our CI test plan, and we frequently use it on our personal development
systems to test prior to creating pull requests.</p>

<p>Functional tests:</p>

<ul>
  <li><code class="highlighter-rouge">basic_test.py</code>: a simple test that checks a range of basic functionality, from flash programming to accessing memory and core registers.</li>
  <li><code class="highlighter-rouge">blank_test.py</code>: tests ability to connect to devices with with blank flash. (Not run by <code class="highlighter-rouge">automated_test.py</code>.)</li>
  <li><code class="highlighter-rouge">commander_test.py</code>: tests the <code class="highlighter-rouge">pyocd commander</code> functionality.</li>
  <li><code class="highlighter-rouge">commands_test.py</code>: tests commands supported by commander and gdb monitor commands.</li>
  <li><code class="highlighter-rouge">concurrency_test.py</code>: verify multiple threads can simultaneously access a debug probe, specifically for memory
  transfers.</li>
  <li><code class="highlighter-rouge">connect_test.py</code>: tests all combinations of the halt on connect and disconnect resume options.</li>
  <li><code class="highlighter-rouge">cortex_test.py</code>: validates CPU control operations and memory accesses.</li>
  <li><code class="highlighter-rouge">debug_context_test.py</code>: tests some <code class="highlighter-rouge">DebugContext</code> classes.</li>
  <li><code class="highlighter-rouge">flash_loader_test.py</code>: test the classes in the <code class="highlighter-rouge">pyocd.flash.loader</code> module.</li>
  <li><code class="highlighter-rouge">flash_test.py</code>: comprehensive test of flash programming.</li>
  <li><code class="highlighter-rouge">import_all.py</code>: imports all pyocd modules. (Not run by <code class="highlighter-rouge">automated_test.py</code>.)</li>
  <li><code class="highlighter-rouge">gdb_test.py</code>: tests the gdbserver by running a script in a gdb process. Note that on Windows,
  the 32-bit Python 2.7 must be installed for the Python-enabled gdb to work properly and for
  this test to pass.</li>
  <li><code class="highlighter-rouge">json_lists_test.py</code>: validates the JSON output from <code class="highlighter-rouge">pyocd json</code>.</li>
  <li><code class="highlighter-rouge">parallel_test.py</code>: checks for issues with accessing debug probes from multiple processes and threads simultaneously. (Not run by <code class="highlighter-rouge">automated_test.py</code>.)</li>
  <li><code class="highlighter-rouge">probeserver_test.py</code>: verify remote probe server and client.</li>
  <li><code class="highlighter-rouge">speed_test.py</code>: performance test for memory reads and writes.</li>
  <li><code class="highlighter-rouge">user_script_test.py</code>: verify loading of user scripts.</li>
</ul>

<h2 id="azure-pipelines">Azure Pipelines</h2>

<p>PyOCD uses Azure Pipelines to run the CI tests for commits and pull requests. The pipeline runs the functional tests on
a set of test machines, called self-hosted test agents in Azure Pipelines parlance. There is one each of Mac, Linux, and
Windows test agents.</p>

<p>The complete results from pipeline runs are <a href="https://dev.azure.com/pyocd/pyocd/_build?definitionId=1&amp;_a=summary">publicly
accessible</a>.</p>

<p>For pull requests, a pyOCD team member or collaborator must manually initiate the pipeline run by entering a special
comment of the form “/azp run” or “/AzurePipelines run”.</p>

<h2 id="testing-with-tox">Testing with tox</h2>

<p>pyOCD includes a configuration file for tox that enables easy testing of multiple Python versions.
The tox tool is included in <code class="highlighter-rouge">test</code> install extra, so it will already be present in a standard
pyOCD developer virtual environment.</p>

<p>To run the functional tests via tox, just execute <code class="highlighter-rouge">tox</code> from the root of the pyOCD
repo. It will create new virtual environments for each Python version and run <code class="highlighter-rouge">automated_test.py</code>.</p>

<p>Currently only the functions tests are included in the tox configuration.</p>

<h2 id="test-setup">Test Setup</h2>

<p>To make the tests pick the correct setup, a <a href="configuration.md"><code class="highlighter-rouge">pyocd.yaml</code> configuration file</a> has to be used.
For functional testing the file should contain a reference to a <code class="highlighter-rouge">test_binary</code> from <code class="highlighter-rouge">test/data/binaries</code>.</p>

<p>Example config file:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">probes</span><span class="pi">:</span>
  <span class="na">E6614103E7176A23</span><span class="pi">:</span> <span class="c1"># Probe's unique ID.</span>
    <span class="na">target_override</span><span class="pi">:</span>  <span class="s">nrf52</span>
    <span class="na">test_binary</span><span class="pi">:</span>      <span class="s">l1_nrf52840-dk.bin</span>
    <span class="na">frequency</span><span class="pi">:</span>        <span class="m">6000000</span>
</code></pre></div></div>


                </div>
              </div>
            </main>

          </div>
        </div>
      </div>

      <div class="flex-shrink-0">
        <footer class="pyocd-footer p-0 mt-3">
  <div class="row row-cols-1 row-cols-sm-2 row-cols-md-4 pt-4">
    <div class="col-3">
      <p class="small">
          Copyright &copy; 2021-2022 PyOCD Authors.
      </p>
      <p class="small">
        Site and docs are <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>.<br/>
        Project code is <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache 2.0</a>.
      </p>
    </div>
    <div class="col-3">  <!-- mt-3 mb-3 mx-4 -->
      <h5>Links</h5>
      <ul class="list-unstyled">
        <li>
          <a href="/docs/">Documentation</a>
        </li>
        <li>
          <a href="/posts/">Posts</a>
        </li>
        <li>
          <a href="https://github.com/pyocd/pyOCD/blob/main/CONTRIBUTING.md">Contributing</a>
        </li>
        <li>
          <a href="https://github.com/pyocd/.github/blob/main/CODE_OF_CONDUCT.md">Code of Conduct</a>
        </li>
        <li>
          <a href="https://github.com/pyocd/">GitHub</a>
        </li>
      </ul>
    </div>
    <div class="col-3">
      <h5>Projects</h5>
      <ul class="list-unstyled">
        <li>
          <a href="https://github.com/pyocd/pyOCD">pyOCD</a>
        </li>
        <li>
          <a href="https://github.com/pyocd/cmsis-pack-manager">cmsis-pack-manager</a>
        </li>
        <li>
          <a href="https://github.com/pyocd/FlashAlgo">FlashAlgo</a>
        </li>
      </ul>
    </div>
    <div class="col-3">
      <h5>Community</h5>
      <ul class="list-unstyled">
        <li>
          <a href="https://github.com/pyocd/pyOCD/issues">Issues</a>
        </li>
        <li>
          <a href="https://github.com/pyocd/pyOCD/discussions">Discussions</a>
        </li>
        <li>
          <a href="https://join.slack.com/t/pyocd/shared_invite/zt-zqjv6zr5-ZfGAXl_mFCGGmFlB_8riHA">Slack</a>
        </li>
        <li>
          <a href="https://groups.google.com/g/pyocd">Mailing list</a>
        </li>
      </ul>
    </div>
  </div>
</footer>

      </div>

      <a href="#top" title="Scroll to top" id="scroll-top-link" aria-hidden="true">
        <i class="bi bi-arrow-up-short"></i>
      </a>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ" crossorigin="anonymous"></script>
<script src="/assets/javascript/jquery-3.6.0.slim.min.js"></script>
<!-- 
<script type="text/javascript" src="/assets/javascript/index.js"></script>
 -->

  </body>

<script>
// Hide the page's floating TOC if there are no sections.
if ($('#toc').children().length < 1) {
  $('#toc-div').hide()
}

// Insert icons for alerts.
$(".alert-warning").prepend("<div class=\"alert-icon\"><i class=\"bi bi-exclamation-triangle\"></i></div>")
$(".alert-info").prepend("<div class=\"alert-icon\"><i class=\"bi bi-info-circle\"></i></div>")
$(".alert-success").prepend("<div class=\"alert-icon\"><i class=\"bi bi-check-circle\"></i></div>")
</script>
</html>
